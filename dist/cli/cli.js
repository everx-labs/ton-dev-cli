"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.handleCommandLine = handleCommandLine;

var _tonClientNodeJs = require("ton-client-node-js");

var _clientCode = require("../compilers/client-code");

var _solidity = require("../compilers/solidity");

var _dev2 = require("../dev");

var _networks = require("../networks/networks");

var _server = require("../server/server");

var _check = require("./check");

var _options = require("./options");

var _info = require("./info.js");

var _spy = require("./spy");

var _trace = require("./trace");

/*
 * Copyright 2018-2020 TON DEV SOLUTIONS LTD.
 *
 * Licensed under the SOFTWARE EVALUATION License (the "License"); you may not use
 * this file except in compliance with the License.  You may obtain a copy of the
 * License at: https://www.ton.dev/licenses
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific TON DEV software governing permissions and
 * limitations under the License.
 *
 */
const USE_EXPERIMENTAL_FEATURES = false;

const program = require('commander');

async function setupCommand(dev, options) {
  await dev.start((0, _options.compilersWithNetworks)(dev, options));
}

async function startCommand(dev, options) {
  await dev.start((0, _options.compilersWithNetworks)(dev, options));
}

async function stopCommand(dev, options) {
  await dev.stop((0, _options.compilersWithNetworks)(dev, options));
}

async function restartCommand(dev, options) {
  await dev.restart((0, _options.compilersWithNetworks)(dev, options));
}

async function recreateCommand(dev, options) {
  await dev.recreate((0, _options.compilersWithNetworks)(dev, options));
}

async function cleanCommand(dev, options) {
  const all = !options.compilers && !options.networks;
  await dev.clean(options.compilers || all, options.networks || all, options.containers);
}

async function setCommand(dev, names, options) {
  await dev.updateNetworkConfigs(dev.networksOrAll(names), config => {
    if (options.newName) {
      config.name = options.newName;
    }

    if (options.port) {
      config.hostPort = options.port;
    }

    if (options.dbPort) {
      if (options.dbPort === 'bind') {
        config.arangoHostPort = _networks.Network.defaultArangoPort;
      } else if (options.dbPort === 'unbind') {
        config.arangoHostPort = '';
      } else {
        config.arangoHostPort = options.dbPort || '';
      }
    }
  });
}

async function addCommand(dev, names) {
  await dev.addNetworks(names);
}

async function removeCommand(dev, names) {
  await dev.removeNetworks(dev.networksFromNames(names));
}

async function generateKeysCommand(_dev) {
  const client = await _tonClientNodeJs.TONClient.create({
    servers: ['http://localhost']
  });
  const keys = await client.crypto.ed25519Keypair();
  console.log(JSON.stringify(keys, undefined, 4));
}

async function testCommand(_dev, servers, options) {
  await _check.CheckNetwork.checkNetworks(servers, options.verbose);
}

async function convertAddress(_dev, addr) {
  const client = await _tonClientNodeJs.TONClient.create({
    servers: ['http://localhost']
  });

  const showConverted = (title, converted) => {
    console.log(`${converted.address === addr ? 'âœ“' : ' '} ${title} = ${converted.address}`);
  };

  const showHex = async () => {
    const converted = await client.contracts.convertAddress({
      address: addr,
      convertTo: 'Hex'
    });
    showConverted('hex', converted);
  };

  const showBase64 = async (test, bounce, url) => {
    const converted = await client.contracts.convertAddress({
      address: addr,
      convertTo: 'Base64',
      base64Params: {
        bounce,
        test,
        url
      }
    });
    const flags = [test ? 'test' : 'main', bounce ? 'bounce' : '', url ? 'url' : ''].filter(x => x !== '').join(' ');
    showConverted(flags, converted);
  };

  await showHex();
  await showBase64(false, false, false);
  await showBase64(false, false, true);
  await showBase64(false, true, false);
  await showBase64(false, true, true);
  await showBase64(true, false, false);
  await showBase64(true, false, true);
  await showBase64(true, true, false);
  await showBase64(true, true, true);
}

async function traceCommand(_dev, server) {
  await _trace.NetworkTracer.traceNetwork(server);
}

async function useCommand(dev, version, options) {
  await dev.useVersion(version, (0, _options.compilersWithNetworks)(dev, options));
}

async function solCommand(dev, files, options) {
  if (files.length < 1) {
    throw new Error('You must specify at least one file name');
  }

  await _solidity.Solidity.build(dev, files, {
    clientLanguages: (options.clientLanguages || '').split(',').filter(x => x),
    clientLevel: options.clientLevel || _clientCode.ClientCodeLevel.run,
    jsModule: options.jsModule || _clientCode.JSModule.node
  });
}

async function genCommand(dev, files, options) {
  if (files.length < 1) {
    throw new Error('You must specify at least one file name');
  }

  await _clientCode.ClientCode.generate(files, {
    clientLanguages: (options.clientLanguages || '').split(','),
    clientLevel: options.clientLevel || _clientCode.ClientCodeLevel.run,
    jsModule: options.jsModule || _clientCode.JSModule.node
  });
}

async function spyCommand(dev, networks) {
  await (0, _spy.spy)(dev, networks);
}

async function webConsoleCommand(dev, options) {
  await (0, _server.web)(dev, options);
}

const networksOption = ['-n, --networks [names]', 'Apply command to specified network[s] (names must be separated with comma).'];
const compilersOption = ['-m, --compilers', 'Apply command to the compilers container.'];

function getSupportedLanguages() {
  return Object.values(_clientCode.ClientCode.languages).map(x => x.shortName);
}

const clientLanguagesOption = ['-l, --client-languages <languages>', `Generate client code for specified languages separated by comma, ` + `supported languages: "${getSupportedLanguages().join('", "')}".`];
const clientLevelOption = ['-L, --client-level <client-level>', 'Client code level: ' + '"run" to run only, ' + '"deploy" to run and deploy (includes an imageBase64 of binary contract)', 'deploy'];
const jsModuleTypeOption = ['--js-module <module-type>', "Java Script module type: " + "`node` to use with `const FooContract = require('foo')`, " + "`nodeNoDefault` to use with `const {FooContract} = require('foo')`, " + "`es` to use with `import FooContract from 'foo'`, " + "`esNoDefault` to use with `import {FooContract} from 'foo'`.", 'node'];

async function handleCommandLine(dev, args) {
  let commandAction = _info.infoCommand;
  let commandArgs = [];

  const command = action => {
    return (...args) => {
      commandAction = action;
      commandArgs = args;
    };
  };

  program.name(dev.name).version(dev.version).option('-a, --available', 'Show available versions.').description('TON Labs development tools');
  program.command('info', {
    isDefault: true
  }).description('Show summary about dev environment.').option('-a, --available', 'Show available versions.').action(command(_info.infoCommand));
  program.command('sol [files...]').description('Build solidity contract[s].').option(...clientLanguagesOption).option(...clientLevelOption).option(...jsModuleTypeOption).action(command(solCommand));
  program.command('gen [files...]').description('Generate client code for contract[s].').option(clientLanguagesOption[0], clientLanguagesOption[1], 'js').option(...clientLevelOption).option(...jsModuleTypeOption).action(command(genCommand));
  program.command('start').description('Start dev containers.').option(...networksOption).option(...compilersOption).action(command(startCommand));
  program.command('stop').description('Stop dev containers.').option(...networksOption).option(...compilersOption).action(command(stopCommand));
  program.command('restart').description('Restart dev containers.').option(...networksOption).option(...compilersOption).action(command(restartCommand));
  program.command('recreate').description('Recreate dev containers.').option(...networksOption).option(...compilersOption).action(command(recreateCommand));
  program.command('setup').description('Setup dev environment.').option(...networksOption).option(...compilersOption).action(command(setupCommand));
  program.command('clean').description('Remove docker containers and images related to TON Dev.').option('-n, --networks', 'Clean local node docker containers and images.').option('-m, --compilers', 'Clean compilers docker containers and images.').option('-c, --containers', 'Clean containers only.', false).action(command(cleanCommand));
  program.command('use <version>').description('Use specified version for containers.').option(...networksOption).option(...compilersOption).action(command(useCommand));
  program.command('set [network...]').description('Set network[s] options.').option('-p, --port <port>', 'Host port to bound local node.').option('-d, --db-port <binding>', 'Host port to bound local nodes Arango DB ("bind" to use default Arango DB port, "unbind" to unbind Arango DB port).').option('-n, --new-name <name>', 'Set new name for network.').action(command(setCommand));
  program.command('add [network...]').description('Add network[s].').action(command(addCommand));
  program.command('remove [network...]').alias('rm').description('Remove network[s].').action(command(removeCommand));
  program.command('test [servers...]').alias('t').description('Test network[s].').option('-v, --verbose', 'Show verbose test log.', false).action(command(testCommand));
  program.command('keys').alias('k').description('Generate random Key Pair.').action(command(generateKeysCommand));
  program.command('addr <addr>').alias('a').description('Convert address.').action(command(convertAddress));

  if (USE_EXPERIMENTAL_FEATURES) {
    program.command('spy [networks...]').description('Run network scanner.').action(command(spyCommand));
    program.command('web').description('Run web console.').option('-p, --port <port>', 'Host port to bound web console.', '8800').action(command(webConsoleCommand));
    program.command('trace <server>').description('Trace message.').action(command(traceCommand));
  }

  program.parse(args);

  if (commandArgs.length === 0) {
    if (program.args.length === 0) {
      await (0, _info.infoCommand)(dev, program);
    } else {
      program.outputHelp();
    }
  } else {
    if (commandAction === _info.infoCommand) {
      const options = commandArgs[commandArgs.length - 1];
      options.available = options.parent.available;
    }

    await commandAction(dev, ...commandArgs);
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jbGkvY2xpLmpzIl0sIm5hbWVzIjpbIlVTRV9FWFBFUklNRU5UQUxfRkVBVFVSRVMiLCJwcm9ncmFtIiwicmVxdWlyZSIsInNldHVwQ29tbWFuZCIsImRldiIsIm9wdGlvbnMiLCJzdGFydCIsInN0YXJ0Q29tbWFuZCIsInN0b3BDb21tYW5kIiwic3RvcCIsInJlc3RhcnRDb21tYW5kIiwicmVzdGFydCIsInJlY3JlYXRlQ29tbWFuZCIsInJlY3JlYXRlIiwiY2xlYW5Db21tYW5kIiwiYWxsIiwiY29tcGlsZXJzIiwibmV0d29ya3MiLCJjbGVhbiIsImNvbnRhaW5lcnMiLCJzZXRDb21tYW5kIiwibmFtZXMiLCJ1cGRhdGVOZXR3b3JrQ29uZmlncyIsIm5ldHdvcmtzT3JBbGwiLCJjb25maWciLCJuZXdOYW1lIiwibmFtZSIsInBvcnQiLCJob3N0UG9ydCIsImRiUG9ydCIsImFyYW5nb0hvc3RQb3J0IiwiTmV0d29yayIsImRlZmF1bHRBcmFuZ29Qb3J0IiwiYWRkQ29tbWFuZCIsImFkZE5ldHdvcmtzIiwicmVtb3ZlQ29tbWFuZCIsInJlbW92ZU5ldHdvcmtzIiwibmV0d29ya3NGcm9tTmFtZXMiLCJnZW5lcmF0ZUtleXNDb21tYW5kIiwiX2RldiIsImNsaWVudCIsIlRPTkNsaWVudCIsImNyZWF0ZSIsInNlcnZlcnMiLCJrZXlzIiwiY3J5cHRvIiwiZWQyNTUxOUtleXBhaXIiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsInRlc3RDb21tYW5kIiwiQ2hlY2tOZXR3b3JrIiwiY2hlY2tOZXR3b3JrcyIsInZlcmJvc2UiLCJjb252ZXJ0QWRkcmVzcyIsImFkZHIiLCJzaG93Q29udmVydGVkIiwidGl0bGUiLCJjb252ZXJ0ZWQiLCJhZGRyZXNzIiwic2hvd0hleCIsImNvbnRyYWN0cyIsImNvbnZlcnRUbyIsInNob3dCYXNlNjQiLCJ0ZXN0IiwiYm91bmNlIiwidXJsIiwiYmFzZTY0UGFyYW1zIiwiZmxhZ3MiLCJmaWx0ZXIiLCJ4Iiwiam9pbiIsInRyYWNlQ29tbWFuZCIsInNlcnZlciIsIk5ldHdvcmtUcmFjZXIiLCJ0cmFjZU5ldHdvcmsiLCJ1c2VDb21tYW5kIiwidmVyc2lvbiIsInVzZVZlcnNpb24iLCJzb2xDb21tYW5kIiwiZmlsZXMiLCJsZW5ndGgiLCJFcnJvciIsIlNvbGlkaXR5IiwiYnVpbGQiLCJjbGllbnRMYW5ndWFnZXMiLCJzcGxpdCIsImNsaWVudExldmVsIiwiQ2xpZW50Q29kZUxldmVsIiwicnVuIiwianNNb2R1bGUiLCJKU01vZHVsZSIsIm5vZGUiLCJnZW5Db21tYW5kIiwiQ2xpZW50Q29kZSIsImdlbmVyYXRlIiwic3B5Q29tbWFuZCIsIndlYkNvbnNvbGVDb21tYW5kIiwibmV0d29ya3NPcHRpb24iLCJjb21waWxlcnNPcHRpb24iLCJnZXRTdXBwb3J0ZWRMYW5ndWFnZXMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJsYW5ndWFnZXMiLCJtYXAiLCJzaG9ydE5hbWUiLCJjbGllbnRMYW5ndWFnZXNPcHRpb24iLCJjbGllbnRMZXZlbE9wdGlvbiIsImpzTW9kdWxlVHlwZU9wdGlvbiIsImhhbmRsZUNvbW1hbmRMaW5lIiwiYXJncyIsImNvbW1hbmRBY3Rpb24iLCJpbmZvQ29tbWFuZCIsImNvbW1hbmRBcmdzIiwiY29tbWFuZCIsImFjdGlvbiIsIm9wdGlvbiIsImRlc2NyaXB0aW9uIiwiaXNEZWZhdWx0IiwiYWxpYXMiLCJwYXJzZSIsIm91dHB1dEhlbHAiLCJhdmFpbGFibGUiLCJwYXJlbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFnQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBV0E7O0FBQ0E7O0FBQ0E7O0FBckNBOzs7Ozs7Ozs7Ozs7OztBQXVDQSxNQUFNQSx5QkFBeUIsR0FBRyxLQUFsQzs7QUFFQSxNQUFNQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxXQUFELENBQXZCOztBQUdBLGVBQWVDLFlBQWYsQ0FBNEJDLEdBQTVCLEVBQXND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O0FBS0FsRyxJQUFBQSxPQUFPLENBQ0ZtSCxPQURMLENBQ2EsZ0JBRGIsRUFDK0JHLFdBRC9CLENBQzJDLGdCQUQzQyxFQUVLRixNQUZMLENBRVlELE9BQU8sQ0FBQzFDLFlBQUQsQ0FGbkI7QUFJSDs7QUFFRHpFLEVBQUFBLE9BQU8sQ0FBQ3lILEtBQVIsQ0FBY1YsSUFBZDs7QUFFQSxNQUFJRyxXQUFXLENBQUNoQyxNQUFaLEtBQXVCLENBQTNCLEVBQThCO0FBQzFCLFFBQUlsRixPQUFPLENBQUMrRyxJQUFSLENBQWE3QixNQUFiLEtBQXdCLENBQTVCLEVBQStCO0FBQzNCLFlBQU0sdUJBQVkvRSxHQUFaLEVBQWlCSCxPQUFqQixDQUFOO0FBQ0gsS0FGRCxNQUVPO0FBQ0hBLE1BQUFBLE9BQU8sQ0FBQzBILFVBQVI7QUFDSDtBQUNKLEdBTkQsTUFNTztBQUNILFFBQUlWLGFBQWEsS0FBS0MsaUJBQXRCLEVBQW1DO0FBQy9CLFlBQU03RyxPQUFPLEdBQUc4RyxXQUFXLENBQUNBLFdBQVcsQ0FBQ2hDLE1BQVosR0FBcUIsQ0FBdEIsQ0FBM0I7QUFDQTlFLE1BQUFBLE9BQU8sQ0FBQ3VILFNBQVIsR0FBb0J2SCxPQUFPLENBQUN3SCxNQUFSLENBQWVELFNBQW5DO0FBQ0g7O0FBQ0QsVUFBTVgsYUFBYSxDQUFDN0csR0FBRCxFQUFNLEdBQUcrRyxXQUFULENBQW5CO0FBQ0g7QUFDSiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxOC0yMDIwIFRPTiBERVYgU09MVVRJT05TIExURC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgU09GVFdBUkUgRVZBTFVBVElPTiBMaWNlbnNlICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcbiAqIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxuICogTGljZW5zZSBhdDogaHR0cHM6Ly93d3cudG9uLmRldi9saWNlbnNlc1xuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgVE9OIERFViBzb2Z0d2FyZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqXG4gKi9cbi8vIEBmbG93XG5cbmltcG9ydCB7IFRPTkNsaWVudCB9IGZyb20gXCJ0b24tY2xpZW50LW5vZGUtanNcIjtcbmltcG9ydCB7IENsaWVudENvZGUsIENsaWVudENvZGVMZXZlbCwgSlNNb2R1bGUgfSBmcm9tIFwiLi4vY29tcGlsZXJzL2NsaWVudC1jb2RlXCI7XG5pbXBvcnQgeyBTb2xpZGl0eSB9IGZyb20gXCIuLi9jb21waWxlcnMvc29saWRpdHlcIjtcbmltcG9ydCB7IERldiB9IGZyb20gXCIuLi9kZXZcIjtcbmltcG9ydCB7IE5ldHdvcmsgfSBmcm9tIFwiLi4vbmV0d29ya3MvbmV0d29ya3NcIjtcbmltcG9ydCB0eXBlIHsgTmV0d29ya0NvbmZpZyB9IGZyb20gXCIuLi9uZXR3b3Jrcy9uZXR3b3Jrc1wiO1xuaW1wb3J0IHsgd2ViIH0gZnJvbSBcIi4uL3NlcnZlci9zZXJ2ZXJcIjtcbmltcG9ydCB7IENoZWNrTmV0d29yayB9IGZyb20gXCIuL2NoZWNrXCI7XG5pbXBvcnQgeyBjb21waWxlcnNXaXRoTmV0d29ya3MgfSBmcm9tIFwiLi9vcHRpb25zXCI7XG5pbXBvcnQgdHlwZSB7XG4gICAgQ2xlYW5PcHRpb25zLFxuICAgIFJlY3JlYXRlT3B0aW9ucyxcbiAgICBSZXN0YXJ0T3B0aW9ucywgU2V0TmV0d29ya09wdGlvbnMsXG4gICAgU2V0dXBPcHRpb25zLCBTb2xPcHRpb25zLFxuICAgIFN0YXJ0T3B0aW9ucyxcbiAgICBTdG9wT3B0aW9ucyxcbiAgICBVc2VPcHRpb25zLCBXZWJPcHRpb25zLFxufSBmcm9tIFwiLi9vcHRpb25zXCI7XG5cbmltcG9ydCB7IGluZm9Db21tYW5kIH0gZnJvbSBcIi4vaW5mby5qc1wiO1xuaW1wb3J0IHsgc3B5IH0gZnJvbSBcIi4vc3B5XCI7XG5pbXBvcnQgeyBOZXR3b3JrVHJhY2VyIH0gZnJvbSBcIi4vdHJhY2VcIjtcblxuY29uc3QgVVNFX0VYUEVSSU1FTlRBTF9GRUFUVVJFUyA9IGZhbHNlO1xuXG5jb25zdCBwcm9ncmFtID0gcmVxdWlyZSgnY29tbWFuZGVyJyk7XG5cblxuYXN5bmMgZnVuY3Rpb24gc2V0dXBDb21tYW5kKGRldjogRGV2LCBvcHRpb25zOiBTZXR1cE9wdGlvbnMpIHtcbiAgICBhd2FpdCBkZXYuc3RhcnQoY29tcGlsZXJzV2l0aE5ldHdvcmtzKGRldiwgb3B0aW9ucykpO1xufVxuXG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0Q29tbWFuZChkZXY6IERldiwgb3B0aW9uczogU3RhcnRPcHRpb25zKSB7XG4gICAgYXdhaXQgZGV2LnN0YXJ0KGNvbXBpbGVyc1dpdGhOZXR3b3JrcyhkZXYsIG9wdGlvbnMpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc3RvcENvbW1hbmQoZGV2OiBEZXYsIG9wdGlvbnM6IFN0b3BPcHRpb25zKSB7XG4gICAgYXdhaXQgZGV2LnN0b3AoY29tcGlsZXJzV2l0aE5ldHdvcmtzKGRldiwgb3B0aW9ucykpO1xufVxuXG5hc3luYyBmdW5jdGlvbiByZXN0YXJ0Q29tbWFuZChkZXY6IERldiwgb3B0aW9uczogUmVzdGFydE9wdGlvbnMpIHtcbiAgICBhd2FpdCBkZXYucmVzdGFydChjb21waWxlcnNXaXRoTmV0d29ya3MoZGV2LCBvcHRpb25zKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlY3JlYXRlQ29tbWFuZChkZXY6IERldiwgb3B0aW9uczogUmVjcmVhdGVPcHRpb25zKSB7XG4gICAgYXdhaXQgZGV2LnJlY3JlYXRlKGNvbXBpbGVyc1dpdGhOZXR3b3JrcyhkZXYsIG9wdGlvbnMpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY2xlYW5Db21tYW5kKGRldjogRGV2LCBvcHRpb25zOiBDbGVhbk9wdGlvbnMpIHtcbiAgICBjb25zdCBhbGwgPSAhb3B0aW9ucy5jb21waWxlcnMgJiYgIW9wdGlvbnMubmV0d29ya3M7XG4gICAgYXdhaXQgZGV2LmNsZWFuKFxuICAgICAgICBvcHRpb25zLmNvbXBpbGVycyB8fCBhbGwsXG4gICAgICAgIG9wdGlvbnMubmV0d29ya3MgfHwgYWxsLFxuICAgICAgICBvcHRpb25zLmNvbnRhaW5lcnMsXG4gICAgKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc2V0Q29tbWFuZChkZXY6IERldiwgbmFtZXM6IHN0cmluZ1tdLCBvcHRpb25zOiBTZXROZXR3b3JrT3B0aW9ucykge1xuICAgIGF3YWl0IGRldi51cGRhdGVOZXR3b3JrQ29uZmlncyhkZXYubmV0d29ya3NPckFsbChuYW1lcyksIChjb25maWc6IE5ldHdvcmtDb25maWcpID0+IHtcbiAgICAgICAgaWYgKG9wdGlvbnMubmV3TmFtZSkge1xuICAgICAgICAgICAgY29uZmlnLm5hbWUgPSBvcHRpb25zLm5ld05hbWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMucG9ydCkge1xuICAgICAgICAgICAgY29uZmlnLmhvc3RQb3J0ID0gb3B0aW9ucy5wb3J0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmRiUG9ydCkge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGJQb3J0ID09PSAnYmluZCcpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuYXJhbmdvSG9zdFBvcnQgPSBOZXR3b3JrLmRlZmF1bHRBcmFuZ29Qb3J0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmRiUG9ydCA9PT0gJ3VuYmluZCcpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuYXJhbmdvSG9zdFBvcnQgPSAnJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmFyYW5nb0hvc3RQb3J0ID0gb3B0aW9ucy5kYlBvcnQgfHwgJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gYWRkQ29tbWFuZChkZXY6IERldiwgbmFtZXM6IHN0cmluZ1tdKSB7XG4gICAgYXdhaXQgZGV2LmFkZE5ldHdvcmtzKG5hbWVzKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQ29tbWFuZChkZXY6IERldiwgbmFtZXM6IHN0cmluZ1tdKSB7XG4gICAgYXdhaXQgZGV2LnJlbW92ZU5ldHdvcmtzKGRldi5uZXR3b3Jrc0Zyb21OYW1lcyhuYW1lcykpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUtleXNDb21tYW5kKF9kZXY6IERldikge1xuICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IFRPTkNsaWVudC5jcmVhdGUoe1xuICAgICAgICBzZXJ2ZXJzOiBbJ2h0dHA6Ly9sb2NhbGhvc3QnXSxcbiAgICB9KTtcbiAgICBjb25zdCBrZXlzID0gYXdhaXQgY2xpZW50LmNyeXB0by5lZDI1NTE5S2V5cGFpcigpO1xuICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGtleXMsIHVuZGVmaW5lZCwgNCkpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB0ZXN0Q29tbWFuZChfZGV2OiBEZXYsIHNlcnZlcnM6IHN0cmluZ1tdLCBvcHRpb25zOiB7IHZlcmJvc2U6IGJvb2xlYW4gfSkge1xuICAgIGF3YWl0IENoZWNrTmV0d29yay5jaGVja05ldHdvcmtzKHNlcnZlcnMsIG9wdGlvbnMudmVyYm9zZSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRBZGRyZXNzKF9kZXY6IERldiwgYWRkcikge1xuICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IFRPTkNsaWVudC5jcmVhdGUoe1xuICAgICAgICBzZXJ2ZXJzOiBbJ2h0dHA6Ly9sb2NhbGhvc3QnXSxcbiAgICB9KTtcbiAgICBjb25zdCBzaG93Q29udmVydGVkID0gKHRpdGxlLCBjb252ZXJ0ZWQpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYCR7Y29udmVydGVkLmFkZHJlc3MgPT09IGFkZHIgPyAn4pyTJyA6ICcgJ30gJHt0aXRsZX0gPSAke2NvbnZlcnRlZC5hZGRyZXNzfWApO1xuICAgIH07XG4gICAgY29uc3Qgc2hvd0hleCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY29udmVydGVkID0gYXdhaXQgY2xpZW50LmNvbnRyYWN0cy5jb252ZXJ0QWRkcmVzcyh7XG4gICAgICAgICAgICBhZGRyZXNzOiBhZGRyLFxuICAgICAgICAgICAgY29udmVydFRvOiAnSGV4JyxcbiAgICAgICAgfSk7XG4gICAgICAgIHNob3dDb252ZXJ0ZWQoJ2hleCcsIGNvbnZlcnRlZCk7XG4gICAgfTtcbiAgICBjb25zdCBzaG93QmFzZTY0ID0gYXN5bmMgKHRlc3QsIGJvdW5jZSwgdXJsKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnRlZCA9IGF3YWl0IGNsaWVudC5jb250cmFjdHMuY29udmVydEFkZHJlc3Moe1xuICAgICAgICAgICAgYWRkcmVzczogYWRkcixcbiAgICAgICAgICAgIGNvbnZlcnRUbzogJ0Jhc2U2NCcsXG4gICAgICAgICAgICBiYXNlNjRQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICBib3VuY2UsXG4gICAgICAgICAgICAgICAgdGVzdCxcbiAgICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZmxhZ3MgPSBbXG4gICAgICAgICAgICB0ZXN0ID8gJ3Rlc3QnIDogJ21haW4nLFxuICAgICAgICAgICAgYm91bmNlID8gJ2JvdW5jZScgOiAnJyxcbiAgICAgICAgICAgIHVybCA/ICd1cmwnIDogJycsXG4gICAgICAgIF1cbiAgICAgICAgICAgIC5maWx0ZXIoeCA9PiB4ICE9PSAnJylcbiAgICAgICAgICAgIC5qb2luKCcgJyk7XG4gICAgICAgIHNob3dDb252ZXJ0ZWQoZmxhZ3MsIGNvbnZlcnRlZCk7XG4gICAgfTtcbiAgICBhd2FpdCBzaG93SGV4KCk7XG4gICAgYXdhaXQgc2hvd0Jhc2U2NChmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICBhd2FpdCBzaG93QmFzZTY0KGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgYXdhaXQgc2hvd0Jhc2U2NChmYWxzZSwgdHJ1ZSwgZmFsc2UpO1xuICAgIGF3YWl0IHNob3dCYXNlNjQoZmFsc2UsIHRydWUsIHRydWUpO1xuICAgIGF3YWl0IHNob3dCYXNlNjQodHJ1ZSwgZmFsc2UsIGZhbHNlKTtcbiAgICBhd2FpdCBzaG93QmFzZTY0KHRydWUsIGZhbHNlLCB0cnVlKTtcbiAgICBhd2FpdCBzaG93QmFzZTY0KHRydWUsIHRydWUsIGZhbHNlKTtcbiAgICBhd2FpdCBzaG93QmFzZTY0KHRydWUsIHRydWUsIHRydWUpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB0cmFjZUNvbW1hbmQoX2RldjogRGV2LCBzZXJ2ZXI6IHN0cmluZykge1xuICAgIGF3YWl0IE5ldHdvcmtUcmFjZXIudHJhY2VOZXR3b3JrKHNlcnZlcik7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVzZUNvbW1hbmQoZGV2OiBEZXYsIHZlcnNpb246IHN0cmluZywgb3B0aW9uczogVXNlT3B0aW9ucykge1xuICAgIGF3YWl0IGRldi51c2VWZXJzaW9uKHZlcnNpb24sIGNvbXBpbGVyc1dpdGhOZXR3b3JrcyhkZXYsIG9wdGlvbnMpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc29sQ29tbWFuZChkZXY6IERldiwgZmlsZXM6IHN0cmluZ1tdLCBvcHRpb25zOiBTb2xPcHRpb25zKSB7XG4gICAgaWYgKGZpbGVzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBzcGVjaWZ5IGF0IGxlYXN0IG9uZSBmaWxlIG5hbWUnKTtcbiAgICB9XG4gICAgYXdhaXQgU29saWRpdHkuYnVpbGQoZGV2LCBmaWxlcywge1xuICAgICAgICBjbGllbnRMYW5ndWFnZXM6IChvcHRpb25zLmNsaWVudExhbmd1YWdlcyB8fCAnJykuc3BsaXQoJywnKS5maWx0ZXIoeCA9PiB4KSxcbiAgICAgICAgY2xpZW50TGV2ZWw6IG9wdGlvbnMuY2xpZW50TGV2ZWwgfHwgQ2xpZW50Q29kZUxldmVsLnJ1bixcbiAgICAgICAganNNb2R1bGU6IG9wdGlvbnMuanNNb2R1bGUgfHwgSlNNb2R1bGUubm9kZSxcbiAgICB9KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2VuQ29tbWFuZChkZXY6IERldiwgZmlsZXM6IHN0cmluZ1tdLCBvcHRpb25zOiBTb2xPcHRpb25zKSB7XG4gICAgaWYgKGZpbGVzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBzcGVjaWZ5IGF0IGxlYXN0IG9uZSBmaWxlIG5hbWUnKTtcbiAgICB9XG4gICAgYXdhaXQgQ2xpZW50Q29kZS5nZW5lcmF0ZShmaWxlcywge1xuICAgICAgICBjbGllbnRMYW5ndWFnZXM6IChvcHRpb25zLmNsaWVudExhbmd1YWdlcyB8fCAnJykuc3BsaXQoJywnKSxcbiAgICAgICAgY2xpZW50TGV2ZWw6IG9wdGlvbnMuY2xpZW50TGV2ZWwgfHwgQ2xpZW50Q29kZUxldmVsLnJ1bixcbiAgICAgICAganNNb2R1bGU6IG9wdGlvbnMuanNNb2R1bGUgfHwgSlNNb2R1bGUubm9kZSxcbiAgICB9KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc3B5Q29tbWFuZChkZXY6IERldiwgbmV0d29ya3M6IHN0cmluZ1tdKSB7XG4gICAgYXdhaXQgc3B5KGRldiwgbmV0d29ya3MpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB3ZWJDb25zb2xlQ29tbWFuZChkZXY6IERldiwgb3B0aW9uczogV2ViT3B0aW9ucykge1xuICAgIGF3YWl0IHdlYihkZXYsIG9wdGlvbnMpO1xufVxuXG5jb25zdCBuZXR3b3Jrc09wdGlvbiA9IFtcbiAgICAnLW4sIC0tbmV0d29ya3MgW25hbWVzXScsXG4gICAgJ0FwcGx5IGNvbW1hbmQgdG8gc3BlY2lmaWVkIG5ldHdvcmtbc10gKG5hbWVzIG11c3QgYmUgc2VwYXJhdGVkIHdpdGggY29tbWEpLidcbl07XG5cbmNvbnN0IGNvbXBpbGVyc09wdGlvbiA9IFtcbiAgICAnLW0sIC0tY29tcGlsZXJzJyxcbiAgICAnQXBwbHkgY29tbWFuZCB0byB0aGUgY29tcGlsZXJzIGNvbnRhaW5lci4nXG5dO1xuXG5mdW5jdGlvbiBnZXRTdXBwb3J0ZWRMYW5ndWFnZXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBPYmplY3QudmFsdWVzKENsaWVudENvZGUubGFuZ3VhZ2VzKS5tYXAoKHg6IGFueSkgPT4geC5zaG9ydE5hbWUpO1xufVxuXG5jb25zdCBjbGllbnRMYW5ndWFnZXNPcHRpb24gPSBbXG4gICAgJy1sLCAtLWNsaWVudC1sYW5ndWFnZXMgPGxhbmd1YWdlcz4nLFxuICAgIGBHZW5lcmF0ZSBjbGllbnQgY29kZSBmb3Igc3BlY2lmaWVkIGxhbmd1YWdlcyBzZXBhcmF0ZWQgYnkgY29tbWEsIGAgK1xuICAgIGBzdXBwb3J0ZWQgbGFuZ3VhZ2VzOiBcIiR7Z2V0U3VwcG9ydGVkTGFuZ3VhZ2VzKCkuam9pbignXCIsIFwiJyl9XCIuYCxcbl07XG5cbmNvbnN0IGNsaWVudExldmVsT3B0aW9uID0gW1xuICAgICctTCwgLS1jbGllbnQtbGV2ZWwgPGNsaWVudC1sZXZlbD4nLFxuICAgICdDbGllbnQgY29kZSBsZXZlbDogJyArXG4gICAgJ1wicnVuXCIgdG8gcnVuIG9ubHksICcgK1xuICAgICdcImRlcGxveVwiIHRvIHJ1biBhbmQgZGVwbG95IChpbmNsdWRlcyBhbiBpbWFnZUJhc2U2NCBvZiBiaW5hcnkgY29udHJhY3QpJyxcbiAgICAnZGVwbG95J1xuXTtcblxuY29uc3QganNNb2R1bGVUeXBlT3B0aW9uID0gW1xuICAgICctLWpzLW1vZHVsZSA8bW9kdWxlLXR5cGU+JyxcbiAgICBcIkphdmEgU2NyaXB0IG1vZHVsZSB0eXBlOiBcIiArXG4gICAgXCJgbm9kZWAgdG8gdXNlIHdpdGggYGNvbnN0IEZvb0NvbnRyYWN0ID0gcmVxdWlyZSgnZm9vJylgLCBcIiArXG4gICAgXCJgbm9kZU5vRGVmYXVsdGAgdG8gdXNlIHdpdGggYGNvbnN0IHtGb29Db250cmFjdH0gPSByZXF1aXJlKCdmb28nKWAsIFwiICtcbiAgICBcImBlc2AgdG8gdXNlIHdpdGggYGltcG9ydCBGb29Db250cmFjdCBmcm9tICdmb28nYCwgXCIgK1xuICAgIFwiYGVzTm9EZWZhdWx0YCB0byB1c2Ugd2l0aCBgaW1wb3J0IHtGb29Db250cmFjdH0gZnJvbSAnZm9vJ2AuXCIsXG4gICAgJ25vZGUnXG5dO1xuXG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNvbW1hbmRMaW5lKGRldjogRGV2LCBhcmdzOiBzdHJpbmdbXSkge1xuICAgIGxldCBjb21tYW5kQWN0aW9uID0gaW5mb0NvbW1hbmQ7XG4gICAgbGV0IGNvbW1hbmRBcmdzID0gW107XG5cbiAgICBjb25zdCBjb21tYW5kID0gKGFjdGlvbikgPT4ge1xuICAgICAgICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgIGNvbW1hbmRBY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICBjb21tYW5kQXJncyA9IGFyZ3M7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLm5hbWUoZGV2Lm5hbWUpXG4gICAgICAgIC52ZXJzaW9uKGRldi52ZXJzaW9uKVxuICAgICAgICAub3B0aW9uKCctYSwgLS1hdmFpbGFibGUnLCAnU2hvdyBhdmFpbGFibGUgdmVyc2lvbnMuJylcbiAgICAgICAgLmRlc2NyaXB0aW9uKCdUT04gTGFicyBkZXZlbG9wbWVudCB0b29scycpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgnaW5mbycsIHsgaXNEZWZhdWx0OiB0cnVlIH0pLmRlc2NyaXB0aW9uKCdTaG93IHN1bW1hcnkgYWJvdXQgZGV2IGVudmlyb25tZW50LicpXG4gICAgICAgIC5vcHRpb24oJy1hLCAtLWF2YWlsYWJsZScsICdTaG93IGF2YWlsYWJsZSB2ZXJzaW9ucy4nKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQoaW5mb0NvbW1hbmQpKTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLmNvbW1hbmQoJ3NvbCBbZmlsZXMuLi5dJykuZGVzY3JpcHRpb24oJ0J1aWxkIHNvbGlkaXR5IGNvbnRyYWN0W3NdLicpXG4gICAgICAgIC5vcHRpb24oLi4uY2xpZW50TGFuZ3VhZ2VzT3B0aW9uKVxuICAgICAgICAub3B0aW9uKC4uLmNsaWVudExldmVsT3B0aW9uKVxuICAgICAgICAub3B0aW9uKC4uLmpzTW9kdWxlVHlwZU9wdGlvbilcbiAgICAgICAgLmFjdGlvbihjb21tYW5kKHNvbENvbW1hbmQpKTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLmNvbW1hbmQoJ2dlbiBbZmlsZXMuLi5dJykuZGVzY3JpcHRpb24oJ0dlbmVyYXRlIGNsaWVudCBjb2RlIGZvciBjb250cmFjdFtzXS4nKVxuICAgICAgICAub3B0aW9uKGNsaWVudExhbmd1YWdlc09wdGlvblswXSwgY2xpZW50TGFuZ3VhZ2VzT3B0aW9uWzFdLCAnanMnKVxuICAgICAgICAub3B0aW9uKC4uLmNsaWVudExldmVsT3B0aW9uKVxuICAgICAgICAub3B0aW9uKC4uLmpzTW9kdWxlVHlwZU9wdGlvbilcbiAgICAgICAgLmFjdGlvbihjb21tYW5kKGdlbkNvbW1hbmQpKTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLmNvbW1hbmQoJ3N0YXJ0JykuZGVzY3JpcHRpb24oJ1N0YXJ0IGRldiBjb250YWluZXJzLicpXG4gICAgICAgIC5vcHRpb24oLi4ubmV0d29ya3NPcHRpb24pXG4gICAgICAgIC5vcHRpb24oLi4uY29tcGlsZXJzT3B0aW9uKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQoc3RhcnRDb21tYW5kKSk7XG5cbiAgICBwcm9ncmFtXG4gICAgICAgIC5jb21tYW5kKCdzdG9wJykuZGVzY3JpcHRpb24oJ1N0b3AgZGV2IGNvbnRhaW5lcnMuJylcbiAgICAgICAgLm9wdGlvbiguLi5uZXR3b3Jrc09wdGlvbilcbiAgICAgICAgLm9wdGlvbiguLi5jb21waWxlcnNPcHRpb24pXG4gICAgICAgIC5hY3Rpb24oY29tbWFuZChzdG9wQ29tbWFuZCkpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgncmVzdGFydCcpLmRlc2NyaXB0aW9uKCdSZXN0YXJ0IGRldiBjb250YWluZXJzLicpXG4gICAgICAgIC5vcHRpb24oLi4ubmV0d29ya3NPcHRpb24pXG4gICAgICAgIC5vcHRpb24oLi4uY29tcGlsZXJzT3B0aW9uKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQocmVzdGFydENvbW1hbmQpKTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLmNvbW1hbmQoJ3JlY3JlYXRlJykuZGVzY3JpcHRpb24oJ1JlY3JlYXRlIGRldiBjb250YWluZXJzLicpXG4gICAgICAgIC5vcHRpb24oLi4ubmV0d29ya3NPcHRpb24pXG4gICAgICAgIC5vcHRpb24oLi4uY29tcGlsZXJzT3B0aW9uKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQocmVjcmVhdGVDb21tYW5kKSk7XG5cbiAgICBwcm9ncmFtXG4gICAgICAgIC5jb21tYW5kKCdzZXR1cCcpLmRlc2NyaXB0aW9uKCdTZXR1cCBkZXYgZW52aXJvbm1lbnQuJylcbiAgICAgICAgLm9wdGlvbiguLi5uZXR3b3Jrc09wdGlvbilcbiAgICAgICAgLm9wdGlvbiguLi5jb21waWxlcnNPcHRpb24pXG4gICAgICAgIC5hY3Rpb24oY29tbWFuZChzZXR1cENvbW1hbmQpKTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLmNvbW1hbmQoJ2NsZWFuJykuZGVzY3JpcHRpb24oJ1JlbW92ZSBkb2NrZXIgY29udGFpbmVycyBhbmQgaW1hZ2VzIHJlbGF0ZWQgdG8gVE9OIERldi4nKVxuICAgICAgICAub3B0aW9uKCctbiwgLS1uZXR3b3JrcycsICdDbGVhbiBsb2NhbCBub2RlIGRvY2tlciBjb250YWluZXJzIGFuZCBpbWFnZXMuJylcbiAgICAgICAgLm9wdGlvbignLW0sIC0tY29tcGlsZXJzJywgJ0NsZWFuIGNvbXBpbGVycyBkb2NrZXIgY29udGFpbmVycyBhbmQgaW1hZ2VzLicpXG4gICAgICAgIC5vcHRpb24oJy1jLCAtLWNvbnRhaW5lcnMnLCAnQ2xlYW4gY29udGFpbmVycyBvbmx5LicsIGZhbHNlKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQoY2xlYW5Db21tYW5kKSk7XG5cbiAgICBwcm9ncmFtXG4gICAgICAgIC5jb21tYW5kKCd1c2UgPHZlcnNpb24+JykuZGVzY3JpcHRpb24oJ1VzZSBzcGVjaWZpZWQgdmVyc2lvbiBmb3IgY29udGFpbmVycy4nKVxuICAgICAgICAub3B0aW9uKC4uLm5ldHdvcmtzT3B0aW9uKVxuICAgICAgICAub3B0aW9uKC4uLmNvbXBpbGVyc09wdGlvbilcbiAgICAgICAgLmFjdGlvbihjb21tYW5kKHVzZUNvbW1hbmQpKTtcblxuICAgIHByb2dyYW1cbiAgICAgICAgLmNvbW1hbmQoJ3NldCBbbmV0d29yay4uLl0nKS5kZXNjcmlwdGlvbignU2V0IG5ldHdvcmtbc10gb3B0aW9ucy4nKVxuICAgICAgICAub3B0aW9uKCctcCwgLS1wb3J0IDxwb3J0PicsICdIb3N0IHBvcnQgdG8gYm91bmQgbG9jYWwgbm9kZS4nKVxuICAgICAgICAub3B0aW9uKFxuICAgICAgICAgICAgJy1kLCAtLWRiLXBvcnQgPGJpbmRpbmc+JyxcbiAgICAgICAgICAgICdIb3N0IHBvcnQgdG8gYm91bmQgbG9jYWwgbm9kZXMgQXJhbmdvIERCIChcImJpbmRcIiB0byB1c2UgZGVmYXVsdCBBcmFuZ28gREIgcG9ydCwgXCJ1bmJpbmRcIiB0byB1bmJpbmQgQXJhbmdvIERCIHBvcnQpLicsXG4gICAgICAgIClcbiAgICAgICAgLm9wdGlvbignLW4sIC0tbmV3LW5hbWUgPG5hbWU+JywgJ1NldCBuZXcgbmFtZSBmb3IgbmV0d29yay4nKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQoc2V0Q29tbWFuZCkpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgnYWRkIFtuZXR3b3JrLi4uXScpLmRlc2NyaXB0aW9uKCdBZGQgbmV0d29ya1tzXS4nKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQoYWRkQ29tbWFuZCkpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgncmVtb3ZlIFtuZXR3b3JrLi4uXScpLmFsaWFzKCdybScpLmRlc2NyaXB0aW9uKCdSZW1vdmUgbmV0d29ya1tzXS4nKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQocmVtb3ZlQ29tbWFuZCkpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgndGVzdCBbc2VydmVycy4uLl0nKS5hbGlhcygndCcpLmRlc2NyaXB0aW9uKCdUZXN0IG5ldHdvcmtbc10uJylcbiAgICAgICAgLm9wdGlvbignLXYsIC0tdmVyYm9zZScsICdTaG93IHZlcmJvc2UgdGVzdCBsb2cuJywgZmFsc2UpXG4gICAgICAgIC5hY3Rpb24oY29tbWFuZCh0ZXN0Q29tbWFuZCkpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgna2V5cycpLmFsaWFzKCdrJykuZGVzY3JpcHRpb24oJ0dlbmVyYXRlIHJhbmRvbSBLZXkgUGFpci4nKVxuICAgICAgICAuYWN0aW9uKGNvbW1hbmQoZ2VuZXJhdGVLZXlzQ29tbWFuZCkpO1xuXG4gICAgcHJvZ3JhbVxuICAgICAgICAuY29tbWFuZCgnYWRkciA8YWRkcj4nKS5hbGlhcygnYScpLmRlc2NyaXB0aW9uKCdDb252ZXJ0IGFkZHJlc3MuJylcbiAgICAgICAgLmFjdGlvbihjb21tYW5kKGNvbnZlcnRBZGRyZXNzKSk7XG5cbiAgICBpZiAoVVNFX0VYUEVSSU1FTlRBTF9GRUFUVVJFUykge1xuICAgICAgICBwcm9ncmFtXG4gICAgICAgICAgICAuY29tbWFuZCgnc3B5IFtuZXR3b3Jrcy4uLl0nKS5kZXNjcmlwdGlvbignUnVuIG5ldHdvcmsgc2Nhbm5lci4nKVxuICAgICAgICAgICAgLmFjdGlvbihjb21tYW5kKHNweUNvbW1hbmQpKTtcblxuICAgICAgICBwcm9ncmFtXG4gICAgICAgICAgICAuY29tbWFuZCgnd2ViJykuZGVzY3JpcHRpb24oJ1J1biB3ZWIgY29uc29sZS4nKVxuICAgICAgICAgICAgLm9wdGlvbignLXAsIC0tcG9ydCA8cG9ydD4nLCAnSG9zdCBwb3J0IHRvIGJvdW5kIHdlYiBjb25zb2xlLicsICc4ODAwJylcbiAgICAgICAgICAgIC5hY3Rpb24oY29tbWFuZCh3ZWJDb25zb2xlQ29tbWFuZCkpO1xuXG4gICAgICAgIHByb2dyYW1cbiAgICAgICAgICAgIC5jb21tYW5kKCd0cmFjZSA8c2VydmVyPicpLmRlc2NyaXB0aW9uKCdUcmFjZSBtZXNzYWdlLicpXG4gICAgICAgICAgICAuYWN0aW9uKGNvbW1hbmQodHJhY2VDb21tYW5kKSk7XG5cbiAgICB9XG5cbiAgICBwcm9ncmFtLnBhcnNlKGFyZ3MpO1xuXG4gICAgaWYgKGNvbW1hbmRBcmdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBpZiAocHJvZ3JhbS5hcmdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgYXdhaXQgaW5mb0NvbW1hbmQoZGV2LCBwcm9ncmFtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2dyYW0ub3V0cHV0SGVscCgpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbW1hbmRBY3Rpb24gPT09IGluZm9Db21tYW5kKSB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0gY29tbWFuZEFyZ3NbY29tbWFuZEFyZ3MubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBvcHRpb25zLmF2YWlsYWJsZSA9IG9wdGlvbnMucGFyZW50LmF2YWlsYWJsZTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBjb21tYW5kQWN0aW9uKGRldiwgLi4uY29tbWFuZEFyZ3MpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgaGFuZGxlQ29tbWFuZExpbmUgfTtcbiJdfQ==